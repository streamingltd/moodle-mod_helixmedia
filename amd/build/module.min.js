/**
 * @package
 * @copyright  2021 Tim Williams Streaming LTD
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_helixmedia/module",["jquery"],(function($){var module={instances:[],first:!0,medialinstance:function($,params){var minst={};return minst.params=params,minst.params.gotIn=!1,minst.params.medialinterval=!1,minst.openmodal=function(evt){evt.preventDefault(),$("#mod_helixmedia_launchframe_"+minst.params.docID).attr("src",minst.params.launchurl),$(".modal-backdrop").css("position","relative"),$(".modal-backdrop").css("z-index","0"),minst.params.doStatusCheck&&(setTimeout(minst.checkStatus,5e3),setTimeout(minst.maintainSession,minst.params.sessionFreq))},minst.closemodalListen=function(evt){evt.preventDefault(),minst.closemodal()},minst.closemodal=function(){if(0!=minst.params.medialinterval&&clearInterval(minst.params.medialinterval),$("#mod_helixmedia_launchframe_"+minst.params.docID).attr("src",""),minst.params.doStatusCheck){var tframe=document.getElementById("mod_helixmedia_thumbframe_"+minst.params.docID);null!==tframe&&void 0!==minst.params.thumburl&&(tframe.contentWindow.location=minst.params.thumburl);var mform1=document.getElementById("mform1");if(null===mform1)mform1=document.getElementsByClassName("mform")[0]}},minst.closeDialogue=function(){$("#mod_helixmedia_modal_"+minst.params.docID).modal("hide"),minst.closemodal()},minst.bind=function(){$("#helixmedia_ltimodal_"+minst.params.docID).click(minst.openmodal),$("#mod_helixmedia_closemodal_"+minst.params.docID).click(minst.closemodalListen)},minst.unbind=function(){$("#helixmedia_ltimodal_"+minst.params.docID).off(),$("#mod_helixmedia_closemodal_"+minst.params.docID).off(),0!=minst.params.medialinterval&&clearInterval(minst.params.medialinterval)},minst.maintainSession=function(){var xmlDoc=new XMLHttpRequest;xmlDoc.open("GET",minst.params.sessionURL,!0),xmlDoc.send(),setTimeout(minst.maintainSession,minst.params.sessionFreq)},minst.checkStatusResponse=function(evt){var responseText=evt.target.responseText;"IN"==responseText&&(minst.params.gotIn=!0),"OUT"!=responseText||0==minst.params.gotIn?0==minst.params.medialinterval&&(minst.params.medialinterval=setInterval(minst.checkStatus,2e3)):0==minst.params.resDelay?minst.closeDialogue():setTimeout(minst.closeDialogue,1e3*minst.params.resDelay)},minst.checkStatus=function(){var xmlDoc=new XMLHttpRequest,params="resource_link_id="+minst.params.resID+"&user_id="+minst.params.userID+"&oauth_consumer_key="+minst.params.oauthConsumerKey;xmlDoc.addEventListener("load",minst.checkStatusResponse),xmlDoc.open("POST",minst.params.statusURL),xmlDoc.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xmlDoc.send(params)},minst},init:function(frameid,launchurl,thumburl,resID,userID,statusURL,oauthConsumerKey,doStatusCheck,sessionURL,sessionFreq,resDelay,extraID){void 0!==module.instances[resID+extraID]&&module.instances[resID+extraID].unbind();var params={};params.frameid=frameid,params.launchurl=launchurl,params.thumburl=thumburl,params.resID=resID,params.userID=userID,params.statusURL=statusURL,params.oauthConsumerKey=oauthConsumerKey,params.doStatusCheck=doStatusCheck,params.sessionURL=sessionURL,params.sessionFreq=sessionFreq,params.resDelay=resDelay,params.docID=resID+extraID;var medialhandler=module.medialinstance($,params);module.instances[params.docID]=medialhandler,medialhandler.bind()}};return module}));

//# sourceMappingURL=module.min.js.map